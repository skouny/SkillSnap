@page "/demo"
@inject PortfolioUserService UserService
@* Demo page to showcase all components *@

<PageTitle>SkillSnap - Demo</PageTitle>

<div class="demo-container">
    <h1>SkillSnap Portfolio Demo</h1>
    
    @if (isLoading)
    {
        <div class="loading-section">
            <p>Loading portfolio data...</p>
        </div>
    }
    else if (user != null)
    {
        <section class="demo-section">
            <ProfileCard Name="@user.Name" 
                         Bio="@user.Bio" 
                         ProfileImageUrl="@user.ProfileImageUrl" />
        </section>

        <section class="demo-section">
            <ProjectList />
        </section>

        <section class="demo-section">
            <SkillTags />
        </section>
    }    else
    {
        <div class="error-section">
            <p><strong>No portfolio data available.</strong></p>
            @if (!string.IsNullOrEmpty(errorMessage))
            {
                <p class="error-details" style="color: red; font-weight: bold;">Error Details: @errorMessage</p>
            }
            <div class="troubleshooting">
                <h4>Troubleshooting Steps:</h4>
                <ol>
                    <li>Make sure the API is running on https://localhost:7129</li>
                    <li>Seed the database by running: <code>POST https://localhost:7129/api/seed</code></li>
                    <li>Check the browser console (F12) for detailed error messages</li>
                    <li>Verify CORS is configured correctly in the API</li>
                </ol>
            </div>
        </div>
    }
</div>

@code {
    private PortfolioUser? user;
    private bool isLoading = true;
    private string? errorMessage;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            user = await UserService.GetFirstUserAsync();
            if (user == null)
            {
                errorMessage = "No user data returned from API";
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading user data: {ex.Message}");
            errorMessage = ex.Message;
        }
        finally
        {
            isLoading = false;
        }
    }
}

<style>
    .demo-container {
        padding: 2rem;
        max-width: 1400px;
        margin: 0 auto;
    }

    .demo-container h1 {
        text-align: center;
        color: #333;
        margin-bottom: 2rem;
        font-size: 2.5rem;
    }    .demo-section {
        margin-bottom: 3rem;
    }

    .loading-section, .error-section {
        text-align: center;
        padding: 3rem;
        color: #666;
    }    .error-section .hint {
        font-family: monospace;
        background-color: #f8f9fa;
        padding: 1rem;
        border-radius: 4px;
        margin-top: 1rem;
        color: #333;
    }

    .troubleshooting {
        text-align: left;
        max-width: 600px;
        margin: 2rem auto;
        padding: 1rem;
        background-color: #fff3cd;
        border-radius: 8px;
        border-left: 4px solid #ffc107;
    }

    .troubleshooting h4 {
        margin-top: 0;
        color: #856404;
    }

    .troubleshooting code {
        background-color: #fff;
        padding: 0.2rem 0.4rem;
        border-radius: 3px;
        font-size: 0.9em;
    }

    .error-details {
        background-color: #f8d7da;
        padding: 1rem;
        border-radius: 4px;
        border-left: 4px solid #dc3545;
        margin: 1rem 0;
    }
</style>
